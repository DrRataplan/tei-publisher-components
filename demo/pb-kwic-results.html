<html>

<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, user-scalable=yes"/>

    <title>pb-link Demo</title>
    <!--scripts-->
    <script src="../node_modules/@webcomponents/webcomponentsjs/webcomponents-loader.js" defer></script>
    <script type="module" src="../src/docs/pb-demo-snippet.js"></script>
    <script type="module" src="../src/pb-page.js"></script>
    <script type="module" src="../src/pb-kwic-results.js"></script>
    <script type="module" src="../src/pb-paginate.js"></script>
    <script type="module" src="../node_modules/@polymer/iron-icons/iron-icons.js"></script>


    <!--/scripts-->
</head>

<body>
<pb-demo-snippet>
    <template>
        <style>
            main {
                display: flex;
            }

            ul {
                flex: 1 0;
                display: block;
                margin-right: 10px;
                padding-right: 10px;
                border-right: 1px solid #333333;
            }

            pb-view {
                height: 70vh;
                overflow: auto;
                flex: 3 0;
            }

            pb-link a {
                color: #333333;
                text-decoration: none;
            }
            section{
                margin-bottom: 2rem;
                display: grid;
                grid-template-columns:30% auto;
                width: 40vw;
                grid-column-gap: 1rem;
            }
            section label{
                white-space: nowrap;
            }
            #perpage, #doc{
                width: 4rem;
            }
        </style>
        <h1>Blacklab KWIC search</h1>
        <section>
            <label for="pattern">Search Pattern:</label>
            <input id="pattern" name="pattern">

            <label for="perpage">Results per Page:</label>
            <input id="perpage" name="perpage" type="number" value="5">

            <label for="doc">limit to Document Id:</label>
            <input id="doc" name="doc">
        </section>


        <pb-page endpoint="http://localhost:8080/exist/apps/blacklab">
            <!--                <pb-document id="document1" path="test/graves6.xml" odd="graves"></pb-document>-->


            <main>
                <pb-kwic-results per-page="5" pattern='[word="love"][word="by"]' path="data"></pb-kwic-results>
                <!--                    <pb-view src="document1" view="div"></pb-view>-->
            </main>
        </pb-page>
    </template>
</pb-demo-snippet>
</body>

<script>
    (function () {
        document.addEventListener('pb-page-ready', () => {
            const kwic = document.querySelector('pb-kwic-results');


            document.querySelector('#doc').addEventListener('blur', (e) => {
                kwic.doc = e.target.value;
                kwic.load();
            });

            const pattern = document.querySelector('#pattern');
            pattern.value = kwic.pattern;

            document.querySelector('#pattern').addEventListener('blur', (e) => {
                kwic.pattern = e.target.value;
                kwic.load();
            });

            document.querySelector('#perpage').addEventListener('blur', (e) => {
                kwic.perPage = e.target.value;
                kwic.load();
            });

        });

    })();

</script>

</html>
